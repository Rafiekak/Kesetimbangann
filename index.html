<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Simulator Kesetimbangan Bus di Tanjakan</title>
<style>
  body {
    margin: 0;
    background: skyblue;
    font-family: Arial;
  }
  canvas {
    display: block;
  }
  .panel {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(255,255,255,0.9);
    padding: 10px;
    border-radius: 8px;
  }
  button {
    margin: 3px;
  }
</style>
</head>
<body>

<canvas id="sim" width="900" height="500"></canvas>

<div class="panel">
  <b>Kontrol Simulator</b><br><br>

  Massa Bus: <span id="massaVal">1000</span> kg<br>
  <input type="range" id="massa" min="500" max="3000" value="1000"><br><br>

  <button onclick="play()">‚ñ∂ Play</button>
  <button onclick="stop()">‚è∏ Stop</button>
  <button onclick="reset()">üîÑ Reset</button>
</div>

<script>
const canvas = document.getElementById("sim");
const ctx = canvas.getContext("2d");

const g = 9.8;
const theta = 15 * Math.PI / 180; // tanjakan gunung
const mu = 0.6;

let m = 1000;
let x0 = 200, y0 = 300;
let x = x0, y = y0;
let v = 0;
let running = false;

// Slider massa
const massaSlider = document.getElementById("massa");
const massaVal = document.getElementById("massaVal");

massaSlider.oninput = function () {
  m = Number(this.value);
  massaVal.innerText = m;
};

// Tombol
function play() { running = true; }
function stop() { running = false; }
function reset() {
  running = false;
  x = x0;
  y = y0;
  v = 0;
}

// ===== BACKGROUND =====
function drawBackground() {

  // Rumput
  ctx.fillStyle = "#3CB371";
  ctx.fillRect(0, 330, 900, 170);

  // Jalan datar
  ctx.fillStyle = "#555";
  ctx.fillRect(0, 300, 350, 60);

  // Jalan tanjakan gunung
  ctx.save();
  ctx.translate(350, 330);
  ctx.rotate(-theta);
  ctx.fillRect(0, -30, 600, 60);
  ctx.restore();

  // Gunung
  drawMountain(650, 330);
  drawMountain(750, 340);

  // Pohon
  drawTree(100, 290);
  drawTree(180, 295);
}

function drawMountain(x, y) {
  ctx.beginPath();
  ctx.moveTo(x - 80, y);
  ctx.lineTo(x, y - 120);
  ctx.lineTo(x + 80, y);
  ctx.fillStyle = "#556B2F";
  ctx.fill();
}

function drawTree(x, y) {
  ctx.fillStyle = "#8B4513";
  ctx.fillRect(x, y, 15, 40);
  ctx.beginPath();
  ctx.arc(x + 8, y - 10, 25, 0, Math.PI * 2);
  ctx.fillStyle = "green";
  ctx.fill();
}

// ===== BUS =====
function drawBus() {
  ctx.fillStyle = "#FF4500";
  ctx.fillRect(x, y - 40, 140, 40);

  // Kaca
  ctx.fillStyle = "#ADD8E6";
  ctx.fillRect(x + 10, y - 35, 40, 25);
  ctx.fillRect(x + 60, y - 35, 60, 25);

  // Pintu
  ctx.fillStyle = "#333";
  ctx.fillRect(x + 120, y - 35, 15, 35);

  // Roda
  ctx.beginPath();
  ctx.arc(x + 30, y, 12, 0, Math.PI * 2);
  ctx.arc(x + 110, y, 12, 0, Math.PI * 2);
  ctx.fillStyle = "black";
  ctx.fill();
}

// ===== INFO =====
function drawText() {
  const Wp = m * g * Math.sin(theta);
  const N = m * g * Math.cos(theta);
  const Fg = mu * N;

  ctx.fillStyle = "black";
  ctx.font = "16px Arial";
  ctx.fillText("SIMULATOR KESETIMBANGAN BUS DI TANJAKAN GUNUNG", 20, 30);
  ctx.fillText("Massa Bus: " + m + " kg", 20, 55);
  ctx.fillText("Gaya Turun (mg sinŒ∏): " + Wp.toFixed(1) + " N", 20, 80);
  ctx.fillText("Gaya Gesek (ŒºN): " + Fg.toFixed(1) + " N", 20, 105);

  if (Wp <= Fg) {
    ctx.fillText("STATUS: SETIMBANG (Bus Diam)", 20, 135);
  } else {
    ctx.fillText("STATUS: TIDAK SETIMBANG (Bus Meluncur)", 20, 135);
  }
}

// ===== FISIKA =====
function update() {
  if (!running) return;

  const Wp = m * g * Math.sin(theta);
  const N = m * g * Math.cos(theta);
  const Fg = mu * N;

  if (Wp > Fg) {
    v += 0.04;
    x += v;
    y += v * Math.tan(theta);
  }
}

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawBackground();
  drawBus();
  drawText();
  update();
  requestAnimationFrame(animate);
}

animate();
</script>

</body>
</html>

